-- ===== 基本服務 =====
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")

local player = Players.LocalPlayer
local PlayerGui = player:WaitForChild("PlayerGui")

-- ===== 全域狀態表=====
_G.FastAttack = true
local Settings = {
    AutoClick = true,
    Distance = 50,
    AttackInterval = 0.01,
    MaxTargets = 20,
    
}

local function IsAlive(char)
    local hum = char:FindFirstChild("Humanoid")
    return hum and hum.Health > 0
end
-- ===== FastAttack 核心 =====
local Net = ReplicatedStorage:WaitForChild("Modules"):WaitForChild("Net")
local RegisterAttack = Net:WaitForChild("RE/RegisterAttack")
local RegisterHit = Net:WaitForChild("RE/RegisterHit")
local EnemiesFolder = workspace:WaitForChild("Enemies")
local CharactersFolder = workspace:WaitForChild("Characters")

-- ================= 免控旋轉核心 =================
local ROTATION_SPEED = 2000
local SLIDE_MAGNITUDE = 350
local JUMP_HEIGHT = 100

local rotating = false
local rotationConn
local currentYaw = 0
local moveKeys = {W=false,A=false,S=false,D=false}
local jumpHold = false

local player = Players.LocalPlayer
local character, root, humanoid

local function setupCharacter(char)
    character = char
    root = char:WaitForChild("HumanoidRootPart")
    humanoid = char:WaitForChild("Humanoid")
    humanoid.AutoRotate = false
end
setupCharacter(player.Character or player.CharacterAdded:Wait())
player.CharacterAdded:Connect(setupCharacter)

-- WASD / Jump
UserInputService.InputBegan:Connect(function(input,gpe)
    if gpe then return end
    if input.KeyCode==Enum.KeyCode.W then moveKeys.W=true end
    if input.KeyCode==Enum.KeyCode.A then moveKeys.A=true end
    if input.KeyCode==Enum.KeyCode.S then moveKeys.S=true end
    if input.KeyCode==Enum.KeyCode.D then moveKeys.D=true end
    if input.KeyCode==Enum.KeyCode.Space then jumpHold=true end
end)

UserInputService.InputEnded:Connect(function(input)
    if input.KeyCode==Enum.KeyCode.W then moveKeys.W=false end
    if input.KeyCode==Enum.KeyCode.A then moveKeys.A=false end
    if input.KeyCode==Enum.KeyCode.S then moveKeys.S=false end
    if input.KeyCode==Enum.KeyCode.D then moveKeys.D=false end
    if input.KeyCode==Enum.KeyCode.Space then jumpHold=false end
end)

local function startRotation()
    if rotating or not root then return end
    rotating = true
    currentYaw = root.Orientation.Y

    rotationConn = RunService.RenderStepped:Connect(function(dt)
        currentYaw += ROTATION_SPEED * dt

        local cam = Workspace.CurrentCamera
        local look = Vector3.new(cam.CFrame.LookVector.X,0,cam.CFrame.LookVector.Z)
        local right = Vector3.new(cam.CFrame.RightVector.X,0,cam.CFrame.RightVector.Z)

        local dir = Vector3.zero
        if moveKeys.W then dir += look end
        if moveKeys.S then dir -= look end
        if moveKeys.A then dir -= right end
        if moveKeys.D then dir += right end
        if dir.Magnitude > 0 then dir = dir.Unit end

        local delta = dir * SLIDE_MAGNITUDE * dt
        if jumpHold then
            delta += Vector3.new(0, JUMP_HEIGHT * dt, 0)
        end

        root.CFrame =
            CFrame.new(root.Position + delta)
            * CFrame.Angles(0, math.rad(currentYaw), 0)
    end)
end

local function stopRotation()
    rotating = false
    if rotationConn then
        rotationConn:Disconnect()
        rotationConn = nil
    end
end

local function toggleRotation(state)
    if state then
        startRotation()
    else
        stopRotation()
    end
end

-- ===== Farm TP 核心狀態 =====
local FarmTP = {
    Enabled = false,
    HoverHeight = 10,
    Range = 500,
    BaseSpeed = 0.1
}

local farmConn

local function stopFarmTP()
    FarmTP.Enabled = false
    if farmConn then
        farmConn:Disconnect()
        farmConn = nil
    end
end

local function startFarmTP()
    if farmConn then return end

    farmConn = RunService.Heartbeat:Connect(function()
        if not FarmTP.Enabled then return end

        local char = player.Character
        local hrp = char and char:FindFirstChild("HumanoidRootPart")
        if not hrp then return end

        local enemiesFolder = workspace:FindFirstChild("Enemies")
        if not enemiesFolder then return end

        local nearest, minDist = nil, math.huge

        for _, npc in ipairs(enemiesFolder:GetChildren()) do
            local hum = npc:FindFirstChild("Humanoid")
            local hrpNpc = npc:FindFirstChild("HumanoidRootPart") or npc:FindFirstChild("Head")
            if hum and hum.Health > 0 and hrpNpc then
                local dist = (hrpNpc.Position - hrp.Position).Magnitude
                if dist < minDist and dist <= FarmTP.Range then
                    minDist = dist
                    nearest = hrpNpc
                end
            end
        end

        if nearest then
            local targetPos = nearest.Position + Vector3.new(0, FarmTP.HoverHeight, 0)
            local speed = FarmTP.BaseSpeed
            if minDist < FarmTP.Range / 2 then
                speed = speed * 5
            end
            hrp.CFrame = CFrame.new(hrp.Position:Lerp(targetPos, speed))
        end
    end)
end

-- ================= 核心 ESP 功能 =================
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer

ESP_ENABLED = false
local ESP_COLOR = Color3.fromRGB(30,30,30)
local TEXT_COLOR = Color3.fromRGB(255,255,255)

local function createESP(player)
    if player == LocalPlayer then return end
    if not player.Character then return end
    if player.Character:FindFirstChild("ESP_Highlight") then return end

    local h = Instance.new("Highlight")
    h.Name = "ESP_Highlight"
    h.FillColor = ESP_COLOR
    h.OutlineColor = Color3.fromRGB(255,255,255)
    h.FillTransparency = 0.2
    h.OutlineTransparency = 0
    h.Adornee = player.Character
    h.Parent = player.Character

    local head = player.Character:FindFirstChild("Head")
    if not head then return end

    local bill = Instance.new("BillboardGui")
    bill.Name = "ESP_Billboard"
    bill.Size = UDim2.fromOffset(180,60)
    bill.StudsOffset = Vector3.new(0,3,0)
    bill.AlwaysOnTop = true
    bill.Parent = head

    local text = Instance.new("TextLabel", bill)
    text.Name = "Info"
    text.Size = UDim2.fromOffset(180,50)
    text.Position = UDim2.new(0,0,0,0)
    text.BackgroundTransparency = 1
    text.TextColor3 = TEXT_COLOR
    text.TextStrokeTransparency = 0
    text.Font = Enum.Font.SourceSansBold
    text.TextSize = 20
    text.TextWrapped = true
    text.TextYAlignment = Enum.TextYAlignment.Top
    text.Text = player.Name

    local barBG = Instance.new("Frame", bill)
    barBG.Name = "HP_Background"
    barBG.Size = UDim2.new(0.8,0,0.08,0)
    barBG.Position = UDim2.new(0.1,0,0.7,0)
    barBG.BackgroundColor3 = Color3.fromRGB(50,50,50)
    barBG.BorderSizePixel = 0

    local barFG = Instance.new("Frame", barBG)
    barFG.Name = "HP_Fill"
    barFG.Size = UDim2.new(1,0,1,0)
    barFG.Position = UDim2.new(0,0,0,0)
    barFG.BackgroundColor3 = Color3.fromRGB(0,255,0)
    barFG.BorderSizePixel = 0
end

local function removeESP(player)
    if player == LocalPlayer then return end
    if not player.Character then return end
    local h = player.Character:FindFirstChild("ESP_Highlight")
    if h then h:Destroy() end
    local head = player.Character:FindFirstChild("Head")
    if head then
        local bill = head:FindFirstChild("ESP_Billboard")
        if bill then bill:Destroy() end
    end
end

local function updateESP()
    if not ESP_ENABLED or not LocalPlayer.Character then return end
    local myHRP = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
    if not myHRP then return end

    for _, p in ipairs(Players:GetPlayers()) do
        if p ~= LocalPlayer and p.Character then
            local humanoid = p.Character:FindFirstChildOfClass("Humanoid")
            local hrp = p.Character:FindFirstChild("HumanoidRootPart")
            local head = p.Character:FindFirstChild("Head")
            if humanoid and hrp and head then
                local bill = head:FindFirstChild("ESP_Billboard")
                if bill then
                    local info = bill:FindFirstChild("Info")
                    local barFG = bill:FindFirstChild("HP_Background") and bill.HP_Background:FindFirstChild("HP_Fill")
                    if info then
                        local dist = math.floor((myHRP.Position - hrp.Position).Magnitude)
                        info.Text = string.format("%s [%dHP]\n距離: %dm", p.Name, math.floor(humanoid.Health), dist)
                    end
                    if barFG then
                        local healthRatio = math.clamp(humanoid.Health / humanoid.MaxHealth,0,1)
                        if healthRatio > 0.6 then
                            barFG.BackgroundColor3 = Color3.fromRGB(0,255,0)
                        elseif healthRatio > 0.3 then
                            barFG.BackgroundColor3 = Color3.fromRGB(255,255,0)
                        else
                            barFG.BackgroundColor3 = Color3.fromRGB(255,0,0)
                        end
                        barFG.Size = UDim2.new(healthRatio,0,1,0)
                    end
                end
            end
        end
    end
end

-- 每幀更新
RunService.RenderStepped:Connect(updateESP)

-- 玩家事件
local function setupPlayerESP(p)
    if p == LocalPlayer then return end
    p.CharacterAdded:Connect(function()
        task.wait(0.2)
        if ESP_ENABLED then createESP(p) end
    end)
    if ESP_ENABLED and p.Character then
        createESP(p)
    end
end

for _, p in ipairs(Players:GetPlayers()) do
    setupPlayerESP(p)
end

Players.PlayerAdded:Connect(setupPlayerESP)
Players.PlayerRemoving:Connect(removeESP)

-- ================= Noclip 核心 =================
local NOCLIP_ENABLED = false
local noclipConn

local function setNoclipState(state)
    NOCLIP_ENABLED = state

    if state then
        if noclipConn then return end
        noclipConn = RunService.Stepped:Connect(function()
            local char = player.Character
            if not char then return end
            for _, part in ipairs(char:GetDescendants()) do
                if part:IsA("BasePart") then
                    part.CanCollide = false
                end
            end
        end)
    else
        if noclipConn then
            noclipConn:Disconnect()
            noclipConn = nil
        end
        
        local char = player.Character
        if char then
            for _, part in ipairs(char:GetDescendants()) do
                if part:IsA("BasePart") then
                    part.CanCollide = true
                end
            end
        end
    end
end

-- ===== Xu-hub UI =====
local screenGui = Instance.new("ScreenGui")
screenGui.Parent = PlayerGui
screenGui.Name = "XuHubGui"

-- 小長方形開關
local toggleBtn = Instance.new("TextButton")
toggleBtn.Size = UDim2.new(0,120,0,50)
toggleBtn.Position = UDim2.new(0.5,-60,0,0)
toggleBtn.Text = "Xu-hub"
toggleBtn.BackgroundColor3 = Color3.fromRGB(50,50,50)
toggleBtn.TextColor3 = Color3.fromRGB(255,255,255)
toggleBtn.BorderSizePixel = 0
toggleBtn.TextScaled = true
toggleBtn.Parent = screenGui
local toggleCorner = Instance.new("UICorner")
toggleCorner.CornerRadius = UDim.new(0,10)
toggleCorner.Parent = toggleBtn

-- 主框架
local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0,900,0,650)
mainFrame.Position = UDim2.new(0.5,-450,0.5,-325)
mainFrame.BackgroundColor3 = Color3.fromRGB(30,30,30)
mainFrame.BackgroundTransparency = 0.3
mainFrame.BorderSizePixel = 0
mainFrame.Visible = false
mainFrame.Parent = screenGui
local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0,10)
UICorner.Parent = mainFrame

-- 標題列
local titleBar = Instance.new("Frame")
titleBar.Size = UDim2.new(1,0,0,50)
titleBar.BackgroundColor3 = Color3.fromRGB(20,20,20)
titleBar.BackgroundTransparency = 0.3
titleBar.Parent = mainFrame

local titleLabel = Instance.new("TextLabel")
titleLabel.Size = UDim2.new(1,-20,1,0)
titleLabel.Position = UDim2.new(0,10,0,0)
titleLabel.Text = "Xu-hub"
titleLabel.TextColor3 = Color3.fromRGB(255,255,255)
titleLabel.BackgroundTransparency = 1
titleLabel.TextXAlignment = Enum.TextXAlignment.Left
titleLabel.Font = Enum.Font.SourceSansBold
titleLabel.TextSize = 32
titleLabel.Parent = titleBar

-- 關閉按鈕
local closeBtn = Instance.new("TextButton")
closeBtn.Size = UDim2.new(0,30,0,30)
closeBtn.Position = UDim2.new(1,-40,0,10)
closeBtn.Text = "X"
closeBtn.BackgroundColor3 = Color3.fromRGB(70,70,70)
closeBtn.BackgroundTransparency = 0.2
closeBtn.TextColor3 = Color3.fromRGB(255,255,255)
closeBtn.Parent = titleBar
closeBtn.MouseButton1Click:Connect(function()
    mainFrame:Destroy()
    toggleBtn:Destroy()
end)

-- 縮小化按鈕 (-)
local minimizeBtn = Instance.new("TextButton")
minimizeBtn.Size = UDim2.new(0,30,0,30)
minimizeBtn.Position = UDim2.new(1,-80,0,10)
minimizeBtn.Text = "-"
minimizeBtn.BackgroundColor3 = Color3.fromRGB(70,70,70)
minimizeBtn.BackgroundTransparency = 0.2
minimizeBtn.TextColor3 = Color3.fromRGB(255,255,255)
minimizeBtn.Parent = titleBar

local isMinimized = false
local originalSize = mainFrame.Size
local originalPosition = mainFrame.Position

-- 左側側欄
local sideBar = Instance.new("ScrollingFrame")
sideBar.Size = UDim2.new(0,180,1,-50)
sideBar.Position = UDim2.new(0,0,0,50)
sideBar.BackgroundColor3 = Color3.fromRGB(50,50,50)
sideBar.BackgroundTransparency = 0.4
sideBar.BorderSizePixel = 0
sideBar.ScrollBarThickness = 6
sideBar.Parent = mainFrame
local sideUICorner = Instance.new("UICorner")
sideUICorner.CornerRadius = UDim.new(0,10)
sideUICorner.Parent = sideBar

-- 右側內容區
local contentFrame = Instance.new("ScrollingFrame")
contentFrame.Size = UDim2.new(1,-180,1,-50)
contentFrame.Position = UDim2.new(0,180,0,50)
contentFrame.BackgroundColor3 = Color3.fromRGB(40,40,40)
contentFrame.BackgroundTransparency = 0.8
contentFrame.BorderSizePixel = 0
contentFrame.ScrollBarThickness = 6
contentFrame.Parent = mainFrame
local contentCorner = Instance.new("UICorner")
contentCorner.CornerRadius = UDim.new(0,10)
contentCorner.Parent = contentFrame

-- 縮小功能
minimizeBtn.MouseButton1Click:Connect(function()
    if not isMinimized then
        mainFrame.Size = UDim2.new(0, originalSize.X.Offset, 0, titleBar.Size.Y.Offset)
        isMinimized = true
        contentFrame.Visible = false
        sideBar.Visible = false
    else
        mainFrame.Size = originalSize
        mainFrame.Position = originalPosition
        isMinimized = false
        contentFrame.Visible = true
        sideBar.Visible = true
    end
end)

-- ===== 側欄按鈕 =====
local buttonNames = {
    "通用", "設定", "Server", "Status", "PVP", 
    "Farm", "自動", "未解鎖", "未解鎖", "未解鎖"
}

local buttons = {}
for i=1,10 do
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(1,-20,0,50)
    btn.Position = UDim2.new(0,10,0,10 + (i-1)*60)
    btn.Text = buttonNames[i]
    btn.BackgroundColor3 = Color3.fromRGB(70,70,70)
    btn.TextColor3 = Color3.fromRGB(255,255,255)
    btn.BorderSizePixel = 0
    btn.TextScaled = true
    btn.Font = Enum.Font.SourceSansBold
    btn.Parent = sideBar

    local btnCorner = Instance.new("UICorner")
    btnCorner.CornerRadius = UDim.new(0,10)
    btnCorner.Parent = btn

    local indicator = Instance.new("Frame")
    indicator.Size = UDim2.new(0,4,1,0)
    indicator.Position = UDim2.new(0,0,0,0)
    indicator.BackgroundColor3 = Color3.fromRGB(0,120,255)
    indicator.Visible = false
    indicator.Parent = btn

    buttons[i] = {Button = btn, Indicator = indicator}
end

-- ===== 右側內容生成函數 =====
local function createOptionRow(parent, yPos, labelText, contentFunc)
    local rowFrame = Instance.new("Frame")
    rowFrame.Size = UDim2.new(1,-20,0,50)
    rowFrame.Position = UDim2.new(0,10,0,yPos)
    rowFrame.BackgroundColor3 = Color3.fromRGB(50,50,50)
    rowFrame.BorderSizePixel = 0
    rowFrame.Parent = parent

    local rowCorner = Instance.new("UICorner")
    rowCorner.CornerRadius = UDim.new(0,10)
    rowCorner.Parent = rowFrame

    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(0,160,1,0)
    label.Position = UDim2.new(0,10,0,0)
    label.BackgroundTransparency = 1
    label.Text = labelText
    label.TextColor3 = Color3.fromRGB(255,255,255)
    label.TextScaled = true
    label.TextSize = 20
    label.TextWrapped = false
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.Parent = rowFrame

    contentFunc(rowFrame)
    return rowFrame
end

-- ===== 右側內容 =====
local function showContent(index)
    contentFrame:ClearAllChildren()
    for i,b in ipairs(buttons) do
        b.Indicator.Visible = (i==index)
    end
    
    if index == 1 then
        local y = 10

		    -- ===== 大標題 =====
    local mainTitle = Instance.new("TextLabel")
    mainTitle.Size = UDim2.new(1, -20, 0, 40)
    mainTitle.Position = UDim2.new(0, 10, 0, y)
    mainTitle.BackgroundTransparency = 1
    mainTitle.Text = "ESP"
    mainTitle.TextColor3 = Color3.fromRGB(50, 50, 50)
    mainTitle.Font = Enum.Font.SourceSansBold
    mainTitle.TextScaled = true
    mainTitle.TextXAlignment = Enum.TextXAlignment.Left
    mainTitle.Parent = contentFrame

        -- 彩虹顏色效果
local hue = 0
RunService.RenderStepped:Connect(function(dt)
    hue = (hue + dt/2) % 1 -- 速度可調整，越小越慢
    mainTitle.TextColor3 = Color3.fromHSV(hue,1,1)
end)
	y = y + 40 -- 下一個選項的 y 位置

-- 建立 ESP 滑動開關
createOptionRow(contentFrame, y, "ESP", function(row)
    local switchBg = Instance.new("Frame")
    switchBg.Size = UDim2.new(0,60,0.5,0)
    switchBg.Position = UDim2.new(1,-70,0.25,0)
    switchBg.BackgroundColor3 = ESP_ENABLED and Color3.fromRGB(0,200,0) or Color3.fromRGB(100,100,100)
    switchBg.BorderSizePixel = 0
    switchBg.Parent = row
    Instance.new("UICorner", switchBg).CornerRadius = UDim.new(0,20)

    local knob = Instance.new("Frame")
    knob.Size = UDim2.new(0,28,1,0)
    knob.Position = ESP_ENABLED and UDim2.new(1,-28,0,0) or UDim2.new(0,0,0,0)
    knob.BackgroundColor3 = Color3.fromRGB(255,255,255)
    knob.BorderSizePixel = 0
    knob.Parent = switchBg
    Instance.new("UICorner", knob).CornerRadius = UDim.new(0,20)

    local function toggleESP()
        ESP_ENABLED = not ESP_ENABLED
        if ESP_ENABLED then
            knob:TweenPosition(UDim2.new(1,-28,0,0),"Out","Quad",0.2,true)
            switchBg.BackgroundColor3 = Color3.fromRGB(0,200,0)
        else
            knob:TweenPosition(UDim2.new(0,0,0,0),"Out","Quad",0.2,true)
            switchBg.BackgroundColor3 = Color3.fromRGB(100,100,100)
        end

        -- 創建或移除 ESP
        for _, p in ipairs(Players:GetPlayers()) do
            if ESP_ENABLED then createESP(p) else removeESP(p) end
        end
    end

    switchBg.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            toggleESP()
        end
    end)
end)
y = y + 60
-- ================= Noclip =================
createOptionRow(contentFrame, y, "穿牆", function(row)
    local switchBg = Instance.new("Frame")
    switchBg.Size = UDim2.new(0,60,0.5,0)
    switchBg.Position = UDim2.new(1,-70,0.25,0)
    switchBg.BackgroundColor3 = NOCLIP_ENABLED and Color3.fromRGB(0,200,0) or Color3.fromRGB(100,100,100)
    switchBg.BorderSizePixel = 0
    switchBg.Parent = row
    Instance.new("UICorner", switchBg).CornerRadius = UDim.new(0,20)

    local knob = Instance.new("Frame")
    knob.Size = UDim2.new(0,28,1,0)
    knob.Position = NOCLIP_ENABLED and UDim2.new(1,-28,0,0) or UDim2.new(0,0,0,0)
    knob.BackgroundColor3 = Color3.fromRGB(255,255,255)
    knob.BorderSizePixel = 0
    knob.Parent = switchBg
    Instance.new("UICorner", knob).CornerRadius = UDim.new(0,20)

    local function toggleNoclip()
        NOCLIP_ENABLED = not NOCLIP_ENABLED
        setNoclipState(NOCLIP_ENABLED)

        if NOCLIP_ENABLED then
            knob:TweenPosition(UDim2.new(1,-28,0,0),"Out","Quad",0.2,true)
            switchBg.BackgroundColor3 = Color3.fromRGB(0,200,0)
        else
            knob:TweenPosition(UDim2.new(0,0,0,0),"Out","Quad",0.2,true)
            switchBg.BackgroundColor3 = Color3.fromRGB(100,100,100)
        end
    end

    switchBg.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            toggleNoclip()
        end
    end)
end)

y = y + 60

    elseif index == 2 then
        local y = 10

		    -- ===== 大標題 =====
    local mainTitle = Instance.new("TextLabel")
    mainTitle.Size = UDim2.new(1, -20, 0, 40)
    mainTitle.Position = UDim2.new(0, 10, 0, y)
    mainTitle.BackgroundTransparency = 1
    mainTitle.Text = "設定"
    mainTitle.TextColor3 = Color3.fromRGB(50, 50, 50)
    mainTitle.Font = Enum.Font.SourceSansBold
    mainTitle.TextScaled = true
    mainTitle.TextXAlignment = Enum.TextXAlignment.Left
    mainTitle.Parent = contentFrame
    
        -- 彩虹顏色效果
local hue = 0
RunService.RenderStepped:Connect(function(dt)
    hue = (hue + dt/2) % 1 -- 速度可調整，越小越慢
    mainTitle.TextColor3 = Color3.fromHSV(hue,1,1)
end)

	y = y + 40 -- 下一個選項的 y 位置
    
    elseif index == 3 then
        local y = 10

		    -- ===== 大標題 =====
    local mainTitle = Instance.new("TextLabel")
    mainTitle.Size = UDim2.new(1, -20, 0, 40)
    mainTitle.Position = UDim2.new(0, 10, 0, y)
    mainTitle.BackgroundTransparency = 1
    mainTitle.Text = "Server"
    mainTitle.TextColor3 = Color3.fromRGB(50, 50, 50)
    mainTitle.Font = Enum.Font.SourceSansBold
    mainTitle.TextScaled = true
    mainTitle.TextXAlignment = Enum.TextXAlignment.Left
    mainTitle.Parent = contentFrame

    -- 彩虹顏色效果
local hue = 0
RunService.RenderStepped:Connect(function(dt)
    hue = (hue + dt/2) % 1 -- 速度可調整，越小越慢
    mainTitle.TextColor3 = Color3.fromHSV(hue,1,1)
end)

	y = y + 40 -- 下一個選項的 y 位置

 -- ===== Hop Server =====
    createOptionRow(contentFrame, y, "Hop Server", function(row)
        local switchBg = Instance.new("Frame")
        switchBg.Size = UDim2.new(0,60,0.5,0)
        switchBg.Position = UDim2.new(1,-70,0.25,0)
        switchBg.BackgroundColor3 = Color3.fromRGB(100,100,100)
        switchBg.BorderSizePixel = 0
        switchBg.Parent = row
        Instance.new("UICorner", switchBg).CornerRadius = UDim.new(0,20)

        local knob = Instance.new("Frame")
        knob.Size = UDim2.new(0,28,1,0)
        knob.Position = UDim2.new(0,0,0,0)
        knob.BackgroundColor3 = Color3.fromRGB(255,255,255)
        knob.BorderSizePixel = 0
        knob.Parent = switchBg
        Instance.new("UICorner", knob).CornerRadius = UDim.new(0,20)

local function toggle()
        knob:TweenPosition(UDim2.new(1,-28,0,0),"Out","Quad",0.2,true)
        switchBg.BackgroundColor3 = Color3.fromRGB(0,200,0)

        task.spawn(function()
            local HttpService = game:GetService("HttpService")
            local TeleportService = game:GetService("TeleportService")
            local PlaceId = game.PlaceId
            local player = game.Players.LocalPlayer

            local AllServers = {}
            local cursor = ""

            -- 取得所有伺服器
            repeat
                local url = "https://games.roblox.com/v1/games/"..PlaceId.."/servers/Public?limit=100"
                if cursor ~= "" then
                    url = url.."&cursor="..cursor
                end
                local success, response = pcall(function()
                    return HttpService:JSONDecode(game:HttpGet(url))
                end)
                if success and response and response.data then
                    for _, s in ipairs(response.data) do
                        if s.id ~= game.JobId and s.playing < s.maxPlayers then
                            table.insert(AllServers, s)
                        end
                    end
                    cursor = response.nextPageCursor or ""
                else
                    cursor = ""
                end
            until cursor == ""

            if #AllServers == 0 then return end

            -- 找玩家數最少的伺服器
            table.sort(AllServers, function(a,b) return a.playing < b.playing end)
            local lowestPlayerServer = AllServers[1]

            TeleportService:TeleportToPlaceInstance(PlaceId, lowestPlayerServer.id, player)
        end)
    end

    switchBg.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then toggle() end
    end)
end)

    y = y + 60

    -- ===== Rejoin =====
    createOptionRow(contentFrame, y, "Rejoin", function(row)
        local switchBg = Instance.new("Frame")
        switchBg.Size = UDim2.new(0,60,0.5,0)
        switchBg.Position = UDim2.new(1,-70,0.25,0)
        switchBg.BackgroundColor3 = Color3.fromRGB(100,100,100)
        switchBg.BorderSizePixel = 0
        switchBg.Parent = row
        Instance.new("UICorner", switchBg).CornerRadius = UDim.new(0,20)

        local knob = Instance.new("Frame")
        knob.Size = UDim2.new(0,28,1,0)
        knob.Position = UDim2.new(0,0,0,0)
        knob.BackgroundColor3 = Color3.fromRGB(255,255,255)
        knob.BorderSizePixel = 0
        knob.Parent = switchBg
        Instance.new("UICorner", knob).CornerRadius = UDim.new(0,20)

        local function toggle()
            knob:TweenPosition(UDim2.new(1,-28,0,0),"Out","Quad",0.2,true)
            switchBg.BackgroundColor3 = Color3.fromRGB(0,200,0)
            task.spawn(function()
                local TeleportService = game:GetService("TeleportService")
                TeleportService:Teleport(game.PlaceId, player)
            end)
        end

        switchBg.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then toggle() end
        end)
    end)
    y = y + 60
    
    -- ===== Join Low Player Server =====
createOptionRow(contentFrame, y, "Join Low Player Server", function(row)
    local switchBg = Instance.new("Frame")
    switchBg.Size = UDim2.new(0,60,0.5,0)
    switchBg.Position = UDim2.new(1,-70,0.25,0)
    switchBg.BackgroundColor3 = Color3.fromRGB(100,100,100)
    switchBg.BorderSizePixel = 0
    switchBg.Parent = row
    Instance.new("UICorner", switchBg).CornerRadius = UDim.new(0,20)

    local knob = Instance.new("Frame")
    knob.Size = UDim2.new(0,28,1,0)
    knob.Position = UDim2.new(0,0,0,0)
    knob.BackgroundColor3 = Color3.fromRGB(255,255,255)
    knob.BorderSizePixel = 0
    knob.Parent = switchBg
    Instance.new("UICorner", knob).CornerRadius = UDim.new(0,20)

    local function toggle()
            knob:TweenPosition(UDim2.new(1,-28,0,0),"Out","Quad",0.2,true)
            switchBg.BackgroundColor3 = Color3.fromRGB(0,200,0)
            task.spawn(function()
                local TeleportService = game:GetService("TeleportService")
                local PlaceId = game.PlaceId
                local AllServers = {} -- 暫存
                local success, servers = pcall(function()
                    return game:GetService("HttpService"):JSONDecode(game:HttpGet("https://games.roblox.com/v1/games/"..PlaceId.."/servers/Public?sortOrder=Asc&limit=100"))
                end)
                if success and servers and servers.data then
                    for _, s in ipairs(servers.data) do
                        if s.id ~= game.JobId and s.playing < s.maxPlayers then
                            table.insert(AllServers, s.id)
                        end
                    end
                end
                if #AllServers > 0 then
                    local randId = AllServers[math.random(1,#AllServers)]
                    TeleportService:TeleportToPlaceInstance(PlaceId, randId, player)
                end
            end)
        end

        switchBg.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then toggle() end
        end)
    end)

 y = y + 60

    elseif index == 4 then
        local y = 10

		    -- ===== 大標題 =====
    local mainTitle = Instance.new("TextLabel")
    mainTitle.Size = UDim2.new(1, -20, 0, 40)
    mainTitle.Position = UDim2.new(0, 10, 0, y)
    mainTitle.BackgroundTransparency = 1
    mainTitle.Text = "狀態"
    mainTitle.TextColor3 = Color3.fromRGB(50, 50, 50)
    mainTitle.Font = Enum.Font.SourceSansBold
    mainTitle.TextScaled = true
    mainTitle.TextXAlignment = Enum.TextXAlignment.Left
    mainTitle.Parent = contentFrame
    
    -- 彩虹顏色效果
local hue = 0
RunService.RenderStepped:Connect(function(dt)
    hue = (hue + dt/2) % 1 -- 速度可調整，越小越慢
    mainTitle.TextColor3 = Color3.fromHSV(hue,1,1)
end)

	y = y + 40 -- 下一個選項的 y 位置

    elseif index == 5 then
        local y = 10

		    -- ===== 大標題 =====
    local mainTitle = Instance.new("TextLabel")
    mainTitle.Size = UDim2.new(1, -20, 0, 40)
    mainTitle.Position = UDim2.new(0, 10, 0, y)
    mainTitle.BackgroundTransparency = 1
    mainTitle.Text = "PVP"
    mainTitle.TextColor3 = Color3.fromRGB(50, 50, 50)
    mainTitle.Font = Enum.Font.SourceSansBold
    mainTitle.TextScaled = true
    mainTitle.TextXAlignment = Enum.TextXAlignment.Left
    mainTitle.Parent = contentFrame

    -- 彩虹顏色效果
local hue = 0
RunService.RenderStepped:Connect(function(dt)
    hue = (hue + dt/2) % 1 -- 速度可調整，越小越慢
    mainTitle.TextColor3 = Color3.fromHSV(hue,1,1)
end)

	y = y + 40 -- 下一個選項的 y 位置

        -- 自動攻擊開關
        createOptionRow(contentFrame, y, "自動攻擊", function(row)
            local switchBg = Instance.new("Frame")
            switchBg.Size = UDim2.new(0,60,0.5,0)
            switchBg.Position = UDim2.new(1,-70,0.25,0)
            switchBg.BackgroundColor3 = Settings.AutoClick and Color3.fromRGB(0,200,0) or Color3.fromRGB(100,100,100)
            switchBg.BorderSizePixel = 0
            switchBg.Parent = row
            local switchCorner = Instance.new("UICorner")
            switchCorner.CornerRadius = UDim.new(0,20)
            switchCorner.Parent = switchBg

            local knob = Instance.new("Frame")
            knob.Size = UDim2.new(0,28,1,0)
            knob.Position = Settings.AutoClick and UDim2.new(1, -28, 0, 0) or UDim2.new(0,0,0,0)
            knob.BackgroundColor3 = Color3.fromRGB(255,255,255)
            knob.BorderSizePixel = 0
            knob.Parent = switchBg
            local knobCorner = Instance.new("UICorner")
            knobCorner.CornerRadius = UDim.new(0,20)
            knobCorner.Parent = knob

            local toggled = Settings.AutoClick
            local function toggleSwitch()
                toggled = not toggled
                Settings.AutoClick = toggled
                if toggled then
                    knob:TweenPosition(UDim2.new(1,-28,0,0),"Out","Quad",0.2,true)
                    switchBg.BackgroundColor3 = Color3.fromRGB(0,200,0)
                else
                    knob:TweenPosition(UDim2.new(0,0,0,0),"Out","Quad",0.2,true)
                    switchBg.BackgroundColor3 = Color3.fromRGB(100,100,100)
                end
            end
            switchBg.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then toggleSwitch() end
            end)
        end)
        y = y + 60

        -- 攻擊距離滑條
        createOptionRow(contentFrame, y, "攻擊距離:", function(row)
            local inputBox = Instance.new("TextBox")
            inputBox.Size = UDim2.new(0,80,0.6,0)
            inputBox.Position = UDim2.new(0,130,0.2,0)
            inputBox.BackgroundColor3 = Color3.fromRGB(70,70,70)
            inputBox.TextColor3 = Color3.fromRGB(255,255,255)
            inputBox.TextScaled = true
            inputBox.ClearTextOnFocus = false
            inputBox.Text = tostring(Settings.Distance)
            inputBox.Parent = row

            local slider = Instance.new("Frame")
            slider.Size = UDim2.new(0,200,0.3,0)
            slider.Position = UDim2.new(0,220,0.35,0)
            slider.BackgroundColor3 = Color3.fromRGB(100,100,100)
            slider.Parent = row
            local fill = Instance.new("Frame")
            fill.Size = UDim2.new(Settings.Distance/1000,0,1,0)
            fill.BackgroundColor3 = Color3.fromRGB(255,200,0)
            fill.Parent = slider

            local maxLabel = Instance.new("TextLabel")
            maxLabel.Size = UDim2.new(0,80,1,0)
            maxLabel.Position = UDim2.new(0,430,0,0)
            maxLabel.BackgroundTransparency = 1
            maxLabel.Text = "(max:1000m)"
            maxLabel.TextColor3 = Color3.fromRGB(200,200,200)
            maxLabel.TextScaled = true
            maxLabel.TextXAlignment = Enum.TextXAlignment.Left
            maxLabel.Parent = row

            local dragging = false
            local MAX_DISTANCE = 1000

            slider.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then dragging = true end
            end)
            slider.InputEnded:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then dragging = false end
            end)
            slider.InputChanged:Connect(function(input)
                if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
                    local mouseX = input.Position.X - slider.AbsolutePosition.X
                    mouseX = math.clamp(mouseX,0,slider.AbsoluteSize.X)
                    local distance = (mouseX/slider.AbsoluteSize.X)*MAX_DISTANCE
                    Settings.Distance = distance
                    inputBox.Text = tostring(math.floor(distance))
                    fill.Size = UDim2.new(mouseX/slider.AbsoluteSize.X,0,1,0)
                end
            end)
            inputBox.FocusLost:Connect(function(enterPressed)
                if enterPressed then
                    local val = tonumber(inputBox.Text)
                    if val then
                        local distance = math.clamp(val,0,MAX_DISTANCE)
                        Settings.Distance = distance
                        inputBox.Text = tostring(math.floor(distance))
                        fill.Size = UDim2.new(distance/MAX_DISTANCE,0,1,0)
                    else
                        inputBox.Text = tostring(math.floor(Settings.Distance))
                    end
                end
            end)
        end)
        y = y + 60
-- ===== 免控旋轉滑動開關 =====
createOptionRow(contentFrame, y, "免控", function(row)
    local switchBg = Instance.new("Frame")
    switchBg.Size = UDim2.new(0,60,0.5,0)
    switchBg.Position = UDim2.new(1,-70,0.25,0)
    switchBg.BackgroundColor3 = rotating and Color3.fromRGB(0,200,0)
        or Color3.fromRGB(100,100,100)
    switchBg.BorderSizePixel = 0
    switchBg.Parent = row
    Instance.new("UICorner", switchBg).CornerRadius = UDim.new(0,20)

    local knob = Instance.new("Frame")
    knob.Size = UDim2.new(0,28,1,0)
    knob.Position = rotating
        and UDim2.new(1,-28,0,0)
        or UDim2.new(0,0,0,0)
    knob.BackgroundColor3 = Color3.fromRGB(255,255,255)
    knob.BorderSizePixel = 0
    knob.Parent = switchBg
    Instance.new("UICorner", knob).CornerRadius = UDim.new(0,20)

    local enabled = rotating
    local function toggle()
        enabled = not enabled
        toggleRotation(enabled)

        if enabled then
            knob:TweenPosition(UDim2.new(1,-28,0,0),"Out","Quad",0.2,true)
            switchBg.BackgroundColor3 = Color3.fromRGB(0,200,0)
        else
            knob:TweenPosition(UDim2.new(0,0,0,0),"Out","Quad",0.2,true)
            switchBg.BackgroundColor3 = Color3.fromRGB(100,100,100)
        end
    end

    switchBg.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            toggle()
        end
    end)
end)

y = y + 60

    elseif index == 6 then
        local y = 10

		    -- ===== 大標題 =====
    local mainTitle = Instance.new("TextLabel")
    mainTitle.Size = UDim2.new(1, -20, 0, 40)
    mainTitle.Position = UDim2.new(0, 10, 0, y)
    mainTitle.BackgroundTransparency = 1
    mainTitle.Text = "Farm"
    mainTitle.TextColor3 = Color3.fromRGB(50, 50, 50)
    mainTitle.Font = Enum.Font.SourceSansBold
    mainTitle.TextScaled = true
    mainTitle.TextXAlignment = Enum.TextXAlignment.Left
    mainTitle.Parent = contentFrame


    -- 彩虹顏色效果
local hue = 0
RunService.RenderStepped:Connect(function(dt)
    hue = (hue + dt/2) % 1 -- 速度可調整，越小越慢
    mainTitle.TextColor3 = Color3.fromHSV(hue,1,1)
end)

	y = y + 40 -- 下一個選項的 y 位置

createOptionRow(contentFrame, y, "TP to NPC", function(row)
    local switchBg = Instance.new("Frame")
    switchBg.Size = UDim2.new(0,60,0.5,0)
    switchBg.Position = UDim2.new(1,-70,0.25,0)
    switchBg.BackgroundColor3 = FarmTP.Enabled and Color3.fromRGB(0,200,0)
        or Color3.fromRGB(100,100,100)
    switchBg.BorderSizePixel = 0
    switchBg.Parent = row
    Instance.new("UICorner", switchBg).CornerRadius = UDim.new(0,20)

    local knob = Instance.new("Frame")
    knob.Size = UDim2.new(0,28,1,0)
    knob.Position = FarmTP.Enabled
        and UDim2.new(1,-28,0,0)
        or UDim2.new(0,0,0,0)
    knob.BackgroundColor3 = Color3.fromRGB(255,255,255)
    knob.BorderSizePixel = 0
    knob.Parent = switchBg
    Instance.new("UICorner", knob).CornerRadius = UDim.new(0,20)

    local function toggle()
        FarmTP.Enabled = not FarmTP.Enabled

        if FarmTP.Enabled then
            knob:TweenPosition(UDim2.new(1,-28,0,0),"Out","Quad",0.2,true)
            switchBg.BackgroundColor3 = Color3.fromRGB(0,200,0)
            startFarmTP()
        else
            knob:TweenPosition(UDim2.new(0,0,0,0),"Out","Quad",0.2,true)
            switchBg.BackgroundColor3 = Color3.fromRGB(100,100,100)
            stopFarmTP()
        end
    end

    switchBg.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            toggle()
        end
    end)
end)

y = y + 60
createOptionRow(contentFrame, y, "飛行高度:", function(row)
    local inputBox = Instance.new("TextBox")
    inputBox.Size = UDim2.new(0,80,0.6,0)
    inputBox.Position = UDim2.new(0,130,0.2,0)
    inputBox.BackgroundColor3 = Color3.fromRGB(70,70,70)
    inputBox.TextColor3 = Color3.fromRGB(255,255,255)
    inputBox.TextScaled = true
    inputBox.ClearTextOnFocus = false
    inputBox.Text = tostring(FarmTP.HoverHeight)
    inputBox.Parent = row

    local slider = Instance.new("Frame")
    slider.Size = UDim2.new(0,200,0.3,0)
    slider.Position = UDim2.new(0,220,0.35,0)
    slider.BackgroundColor3 = Color3.fromRGB(100,100,100)
    slider.Parent = row

    local fill = Instance.new("Frame")
    fill.Size = UDim2.new(FarmTP.HoverHeight/50,0,1,0)
    fill.BackgroundColor3 = Color3.fromRGB(255,150,0)
    fill.Parent = slider

    local MAX_HEIGHT = 50
    local dragging = false

    slider.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then dragging = true end
    end)
    slider.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then dragging = false end
    end)
    slider.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local x = math.clamp(input.Position.X - slider.AbsolutePosition.X,0,slider.AbsoluteSize.X)
            local val = math.floor((x/slider.AbsoluteSize.X)*MAX_HEIGHT)
            FarmTP.HoverHeight = val
            inputBox.Text = tostring(val)
            fill.Size = UDim2.new(x/slider.AbsoluteSize.X,0,1,0)
        end
    end)
end)

y = y + 60
createOptionRow(contentFrame, y, "TP範圍:", function(row)
    local inputBox = Instance.new("TextBox")
    inputBox.Size = UDim2.new(0,80,0.6,0)
    inputBox.Position = UDim2.new(0,130,0.2,0)
    inputBox.BackgroundColor3 = Color3.fromRGB(70,70,70)
    inputBox.TextColor3 = Color3.fromRGB(255,255,255)
    inputBox.TextScaled = true
    inputBox.ClearTextOnFocus = false
    inputBox.Text = tostring(FarmTP.Range)
    inputBox.Parent = row

    local slider = Instance.new("Frame")
    slider.Size = UDim2.new(0,200,0.3,0)
    slider.Position = UDim2.new(0,220,0.35,0)
    slider.BackgroundColor3 = Color3.fromRGB(100,100,100)
    slider.Parent = row

    local fill = Instance.new("Frame")
    fill.Size = UDim2.new(FarmTP.Range/2000,0,1,0)
    fill.BackgroundColor3 = Color3.fromRGB(0,255,150)
    fill.Parent = slider

    local MAX_RANGE = 2000
    local dragging = false

    slider.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then dragging = true end
    end)
    slider.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then dragging = false end
    end)
    slider.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local x = math.clamp(input.Position.X - slider.AbsolutePosition.X,0,slider.AbsoluteSize.X)
            local val = math.floor((x/slider.AbsoluteSize.X)*MAX_RANGE)
            FarmTP.Range = val
            inputBox.Text = tostring(val)
            fill.Size = UDim2.new(x/slider.AbsoluteSize.X,0,1,0)
        end
    end)
end)

y = y + 60

    elseif index == 7 then
        local y = 10

		    -- ===== 大標題 =====
    local mainTitle = Instance.new("TextLabel")
    mainTitle.Size = UDim2.new(1, -20, 0, 40)
    mainTitle.Position = UDim2.new(0, 10, 0, y)
    mainTitle.BackgroundTransparency = 1
    mainTitle.Text = "自動"
    mainTitle.TextColor3 = Color3.fromRGB(50, 50, 50)
    mainTitle.Font = Enum.Font.SourceSansBold
    mainTitle.TextScaled = true
    mainTitle.TextXAlignment = Enum.TextXAlignment.Left
    mainTitle.Parent = contentFrame

    -- 彩虹顏色效果
local hue = 0
RunService.RenderStepped:Connect(function(dt)
    hue = (hue + dt/2) % 1 -- 速度可調整，越小越慢
    mainTitle.TextColor3 = Color3.fromHSV(hue,1,1)
end)

	y = y + 40 -- 下一個選項的 y 位置

    elseif index == 8 then
        local y = 10

		    -- ===== 大標題 =====
    local mainTitle = Instance.new("TextLabel")
    mainTitle.Size = UDim2.new(1, -20, 0, 100)
    mainTitle.Position = UDim2.new(0, 10, 0, y)
    mainTitle.BackgroundTransparency = 1
    mainTitle.Text = "未解鎖"
    mainTitle.TextColor3 = Color3.fromRGB(50, 50, 50)
    mainTitle.Font = Enum.Font.SourceSansBold
    mainTitle.TextScaled = true
    mainTitle.TextXAlignment = Enum.TextXAlignment.Left
    mainTitle.Parent = contentFrame

    -- 彩虹顏色效果
local hue = 0
RunService.RenderStepped:Connect(function(dt)
    hue = (hue + dt/2) % 1 -- 速度可調整，越小越慢
    mainTitle.TextColor3 = Color3.fromHSV(hue,1,1)
end)

	y = y + 40 -- 下一個選項的 y 位置

    elseif index == 9 then
        local y = 10

		    -- ===== 大標題 =====
    local mainTitle = Instance.new("TextLabel")
    mainTitle.Size = UDim2.new(1, -20, 0, 100)
    mainTitle.Position = UDim2.new(0, 10, 0, y)
    mainTitle.BackgroundTransparency = 1
    mainTitle.Text = "未解鎖"
    mainTitle.TextColor3 = Color3.fromRGB(50, 50, 50)
    mainTitle.Font = Enum.Font.SourceSansBold
    mainTitle.TextScaled = true
    mainTitle.TextXAlignment = Enum.TextXAlignment.Left
    mainTitle.Parent = contentFrame

    -- 彩虹顏色效果
local hue = 0
RunService.RenderStepped:Connect(function(dt)
    hue = (hue + dt/2) % 1 -- 速度可調整，越小越慢
    mainTitle.TextColor3 = Color3.fromHSV(hue,1,1)
end)

	y = y + 40 -- 下一個選項的 y 位置

    elseif index == 10 then
        local y = 10

		    -- ===== 大標題 =====
    local mainTitle = Instance.new("TextLabel")
    mainTitle.Size = UDim2.new(1, -20, 0, 100)
    mainTitle.Position = UDim2.new(0, 10, 0, y)
    mainTitle.BackgroundTransparency = 1
    mainTitle.Text = "未解鎖"
    mainTitle.TextColor3 = Color3.fromRGB(50, 50, 50)
    mainTitle.Font = Enum.Font.SourceSansBold
    mainTitle.TextScaled = true
    mainTitle.TextXAlignment = Enum.TextXAlignment.Left
    mainTitle.Parent = contentFrame
    
        -- 彩虹顏色效果
local hue = 0
RunService.RenderStepped:Connect(function(dt)
    hue = (hue + dt/2) % 1 -- 速度可調整，越小越慢
    mainTitle.TextColor3 = Color3.fromHSV(hue,1,1)
end)

	y = y + 40 -- 下一個選項的 y 位置

    end
end

-- ===== 點擊側欄按鈕顯示內容（內容區完全空白） =====
for i,b in ipairs(buttons) do
    b.Button.MouseButton1Click:Connect(function()
        showContent(i)
    end)
end

-- 顯示 / 隱藏主框架
toggleBtn.MouseButton1Click:Connect(function()
    mainFrame.Visible = not mainFrame.Visible
end)

-- ===== 可拖動功能 =====
local dragging = false
local dragInput
local dragStart
local startPos

local function update(input)
    local delta = input.Position - dragStart
    mainFrame.Position = UDim2.new(
        startPos.X.Scale,
        startPos.X.Offset + delta.X,
        startPos.Y.Scale,
        startPos.Y.Offset + delta.Y
    )
end

titleBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = mainFrame.Position

        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

titleBar.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        update(input)
    end
end)

-- ===== FastAttack 核心執行 =====
task.spawn(function()
    while _G.FastAttack do
        if Settings.AutoClick then
            local root = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
            if root then
                local targets = {}
                for _, folder in ipairs({EnemiesFolder, CharactersFolder}) do
                    for _, obj in ipairs(folder:GetChildren()) do
                        if obj ~= player.Character then
                            local head = obj:FindFirstChild("Head")
                            if head and IsAlive(obj) then
                                local dist = (head.Position - root.Position).Magnitude
                                if dist <= Settings.Distance then
                                    table.insert(targets,{obj,head})
                                    if #targets >= Settings.MaxTargets then break end
                                end
                            end
                        end
                        if #targets >= Settings.MaxTargets then break end
                    end
                    if #targets >= Settings.MaxTargets then break end
                end

                local aliveTargets = {}
                for _, t in ipairs(targets) do
                    if IsAlive(t[1]) then
                        table.insert(aliveTargets, t)
                    end
                end

                if #aliveTargets > 0 then
                    RegisterAttack:FireServer(0)
                    RegisterHit:FireServer(aliveTargets[1][2], aliveTargets)
                end
            end
        end
        task.wait(Settings.AttackInterval)
    end
end)
